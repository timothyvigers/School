knitr::opts_chunk$set(echo=TRUE,dpi = 600)
library(shinyMethyl)
library(minfi)
library(bumphunter)
library(IlluminaHumanMethylation450kanno.ilmn12.hg19)
library(arsenal)
baseDir = "C:/Users/tim/Dropbox/Documents/School/Statistical Genomics/Homework Files/HW7/idats"
targets = read.metharray.sheet(baseDir)
rgSet = read.metharray.exp(targets = targets)
annotation(rgSet)
df = as.data.frame(pData(rgSet))
df = df[df$Status == "cancer",]
t1 = tableby(~ patient.age_at_initial_pathologic_diagnosis +
patient.height + patient.weight + Sex +  patient.race,
data = df)
summary(t1,labelTranslations =
list(patient.age_at_initial_pathologic_diagnosis =
"Age at Diagnosis",
patient.height = "Height",patient.weight = "Weight",
patient.race = "Race"))
getManifest(rgSet)
id = pData(rgSet)$id
densityPlot(rgSet,sampGroups = id)
densityBeanPlot(rgSet,sampGroups = id)
stype = pData(rgSet)$sample_type
densityPlot(rgSet,sampGroups = stype)
densityBeanPlot(rgSet,sampGroups = stype)
sex = pData(rgSet)$Sex
densityPlot(rgSet,sampGroups = sex)
densityBeanPlot(rgSet,sampGroups = sex)
controlStripPlot(rgSet)
?controlStripPlot
controlStripPlot(rgSet,controls = "BISULFITE CONVERSION I")
controlStripPlot(rgSet,controls = "NEGATIVE")
detectionP(rgSet)
detect = detectionP(rgSet)
dim(detect)
colSums(detect >= 0.05)
colSums(detect >= 0.05)
colnames(detec)[which.max(colSums(detect >= 0.05))]
colnames(detect)[which.max(colSums(detect >= 0.05))]
max(colSums(detect >= 0.05))
max(colSums(detect >= 0.05))
(max(colSums(detect >= 0.05))/nrow(detect))
max(colSums(detect >= 0.05))/nrow(detect)*100
nrow(detec)
nrow(detect)
681/485512
max(colSums(detect >= 0.05))/nrow(detect)
round(max(colSums(detect >= 0.05))/nrow(detect)*100,3)
rowMeans(detect)
View(detect)
# Row means
rmeans = rowMeans(detect)
rmeans
sum(rmeans >- 0.05)
sum(rmeans >= 0.05)
mset <- preprocessRaw(rgSet)
msetSWAN <- preprocessSWAN(rgSet)
?mdsPlot
mdsPlot(msetSWAN)
