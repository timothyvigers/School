knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(MASS)
library(tidyverse)
cereal <- read.csv("/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/Cereal2.csv")
View(cereal)
pois_mod <- glm(Cond ~ C1 + Sex + Wt1, data = cereal)
pois_mod <- glm(Cond ~ C1 + Sex + Wt1, data = cereal, family = poisson(link=log))
kable(summary(pois_mod)$coefficients)
pois_mod <- glm(Cond ~ C1 + Sex + Wt1, data = cereal, family = quasipoisson(link=log))
kable(summary(pois_mod)$coefficients)
pois_mod <- glm(Cond ~ C1 + Sex + Wt1, data = cereal, family = poisson(link=log))
kable(summary(pois_mod)$coefficients)
pois_mod <- glm(Cond ~ C1 + Sex + Wt1, data = cereal, family = quasipoisson(link=log))
kable(summary(pois_mod)$coefficients)
pois_mod <- glm(Cond ~ C1 + Sex + Wt1, data = cereal, family = poisson(link=log))
kable(summary(pois_mod)$coefficients)
pois_mod <- glm(Cond ~ C1 + Sex + Wt1, data = cereal, family = quasipoisson(link=log))
kable(summary(pois_mod)$coefficients)
cereal <- cereal %>% unite(FamIDNO,FamMem,remove = F)
View(cereal)
?unite
cereal <- read.csv("/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/Cereal2.csv")
cereal <- cereal %>% unite(id = FamIDNO,FamMem,remove = F)
cereal <- cereal %>% unite(id, FamIDNO,FamMem,remove = F)
View(cereal)
write.csv(cereal,file = "/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/cereal_sas.csv",row.names = F,na="")
cereal <- read.csv("/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/Cereal2.csv")
cereal <- cereal %>% unite(id, FamIDNO,FamMem,remove = F)
View(cereal)
write.csv(cereal,file = "/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/cereal_sas.csv",row.names = F,na="")
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(MASS)
library(glmmML)
library(tidyverse)
cereal <- read.csv("/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/Cereal2.csv")
cereal <- cereal %>% unite(id, FamIDNO,FamMem,remove = F)
quasi_pois_mod <- glmmML(Cond ~ C1 + Sex + Wt1, data = cereal, family = poisson(link=log), cluster = id)
View(cereal)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|id), data = cereal, family = poisson(link=log))
library(lmer)
library(lme4)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|id), data = cereal, family = poisson(link=log))
library(lme4)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|id), data = cereal, family = poisson(link=log))
kable(summary(norm_err_pois_mod)$coefficients)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|id), data = cereal, family = poisson(link=log))
kable(summary(norm_err_pois_mod)$coefficients)
norm_err_pois_mod <- glmmML(Cond ~ C1 + Sex + Wt1, data = cereal, family = poisson(link=log),cluster = id)
norm_err_pois_mod <- glmmML(Cond ~ C1 + Sex + Wt1, data = cereal, family = poisson(link=log),cluster = id)
source('~/.active-rstudio-document', echo=TRUE)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|id), data = cereal, family = poisson(link=log))
View(cereal)
View(cereal)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|FamIDNO), data = cereal, family = poisson(link=log))
kable(summary(norm_err_pois_mod)$coefficients)
cereal$FamIDNO <- as.factor(cereal$FamIDNO)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|FamIDNO), data = cereal, family = poisson(link=log))
kable(summary(norm_err_pois_mod)$coefficients)
kable(summary(norm_err_pois_mod)$coefficients)
summary(norm_err_pois_mod)
View(cereal)
cereal <- read.csv("/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/Cereal2.csv")
cereal <- cereal %>% filter(FamMem == 3)
cereal$FamIDNO <- as.factor(cereal$FamIDNO)
write.csv(cereal,file = "/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/cereal_sas.csv",row.names = F,na="")
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|FamIDNO), data = cereal, family = poisson(link=log))
View(cereal)
cereal <- read.csv("/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/Cereal2.csv")
cereal <- cereal %>% filter(FamMem == 3)
cereal$FamIDNO <- as.factor(cereal$FamIDNO)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|FamIDNO), data = cereal, family = poisson(link=log))
View(cereal)
cereal <- read.csv("/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/Cereal2.csv")
cereal <- cereal %>% filter(FamMem == 3)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|FamIDNO), data = cereal, family = poisson(link=log))
View(cereal)
cereal$Cond <- as.factor(cereal$Cond)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|FamIDNO), data = cereal, family = poisson(link=log))
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|FamIDNO), data = cereal, family = poisson(link=log))
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(MASS)
library(lme4)
library(tidyverse)
cereal <- read.csv("/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/Cereal2.csv")
cereal <- cereal %>% filter(FamMem == 3)
pois_mod <- glm(Cond ~ C1 + Sex + Wt1, data = cereal, family = poisson(link=log))
kable(summary(pois_mod)$coefficients)
quasi_pois_mod <- glm(Cond ~ C1 + Sex + Wt1, data = cereal, family = quasipoisson(link=log))
kable(summary(quasi_pois_mod)$coefficients)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|FamIDNO), data = cereal, family = poisson(link=log))
View(cereal)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|FamIDNO), data = cereal, family = poisson())
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|FamIDNO), data = cereal, family = poisson)
cereal$FamIDNO <- as.factor(cereal$FamIDNO)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|FamIDNO), data = cereal, family = poisson(link=log))
norm_err_pois_mod <- glmmML(Cond ~ C1 + Sex + Wt1, data = cereal, family = poisson(link=log), cluster=FamIDNO)
norm_err_pois_mod <- glmer(factor(Cond) ~ C1 + Sex + Wt1 + (1|FamIDNO), data = cereal, family = poisson(link=log))
source('~/.active-rstudio-document', echo=TRUE)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|FamIDNO), data = cereal, family = poisson(link=log))
cereal$id <- seq(1:nrow(cereal))
View(cereal)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|id), data = cereal, family = poisson(link=log))
str(cereal)
cereal <- read.csv("/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/Cereal2.csv")
cereal <- cereal %>% filter(FamMem == 3)
cereal$id <- seq(1:nrow(cereal))
View(cereal)
write.csv(cereal,file = "/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/cereal_sas.csv",row.names = F,na="")
pois_mod <- glm(Cond ~ C1 + Sex + Wt1, data = cereal, family = poisson(link=log))
kable(summary(pois_mod)$coefficients)
quasi_pois_mod <- glm(Cond ~ C1 + Sex + Wt1, data = cereal, family = quasipoisson(link=log))
kable(summary(quasi_pois_mod)$coefficients)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|id), data = cereal, family = poisson(link=log))
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|id), data = cereal, family = poisson(link=log))
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(MASS)
library(lme4)
library(tidyverse)
cereal <- read.csv("/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/Cereal2.csv")
cereal <- cereal %>% filter(FamMem == 3)
cereal$id <- seq(1:nrow(cereal))
pois_mod <- glm(Cond ~ C1 + Sex + Wt1, data = cereal, family = poisson(link=log))
kable(summary(pois_mod)$coefficients)
quasi_pois_mod <- glm(Cond ~ C1 + Sex + Wt1, data = cereal, family = quasipoisson(link=log))
kable(summary(quasi_pois_mod)$coefficients)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|id), data = cereal,
family = poisson(link=log))
kable(summary(norm_err_pois_mod)$coefficients)
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|id), data = cereal,
family = poisson(link=log))
norm_err_pois_mod <- glmer(Cond ~ C1 + Sex + Wt1 + (1|id), data = cereal,
family = poisson(link=log))
library(glmmML)
norm_err_pois_mod <- glmmML(Cond ~ C1 + Sex + Wt1, data = cereal, cluster = id,
family = poisson(link=log))
kable(summary(norm_err_pois_mod)$coefficients)
summary(norm_err_pois_mod)$coefficients
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(MASS)
library(lme4)
library(tidyverse)
cereal <- read.csv("/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/Cereal2.csv")
cereal <- cereal %>% filter(FamMem == 3)
cereal$id <- seq(1:nrow(cereal))
norm_err_pois_mod <- glmmML(Cond ~ C1 + Sex + Wt1, data = cereal, cluster = id,
family = poisson(link=log))
summary(norm_err_pois_mod)$coefficients
temp <- glmer(factor(Cond) ~ C1 + Sex + Wt1 + (1|id),family = poisson(link=log))
temp <- glmer(factor(Cond) ~ C1 + Sex + Wt1 + (1|id),family = poisson(link=log),
data = cereal)
temp <- glmer(Cond ~ C1 + Sex + Wt1 + (1|id),family = poisson(link=log),
data = cereal)
temp <- glmer(Cond ~ C1 + Sex + Wt1 + (1|id),family = poisson,
data = cereal)
norm_err_pois_mod <- glmmML(Cond ~ C1 + Sex + Wt1, data = cereal, cluster = id,
family = poisson(link=log))
norm_err_pois_mod
write.csv(cereal,file = "/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/cereal_sas.csv",row.names = F,na="")
View(cereal)
rm(temp)
test <- glmer(Cond ~ C1 + Sex + Wt1 + (1 | id), family=poisson( link=log ), data=cereal )
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(MASS)
library(glmmML)
library(lme4)
library(tidyverse)
summ <- summary(norm_err_pois_mod)
summ
summ <- summary(norm_err_pois_mod)
summ$
))
$
norm_err_pois_mod <- glmmML(Cond ~ C1 + Sex + Wt1, data = cereal, cluster = id,
family = poisson(link=log))
norm_err_pois_mod2 <- glmer(Cond ~ C1 + Sex + Wt1 + (1|id),family = poisson,
data = cereal)
summary(norm_err_pois_mod2)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(MASS)
library(glmmML)
library(lme4)
library(tidyverse)
cereal <- read.csv("/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Homework 4/Cereal2.csv")
cereal <- cereal %>% filter(FamMem == 3)
cereal$id <- seq(1:nrow(cereal))
pois_mod <- glm(C1 ~ Cond + Sex + Wt1, data = cereal, family = poisson(link=log))
kable(summary(pois_mod)$coefficients)
quasi_pois_mod <- glm(C1 ~ Cond + Sex + Wt1, data = cereal, family = quasipoisson(link=log))
kable(summary(quasi_pois_mod)$coefficients)
norm_err_pois_mod2 <- glmer(C1 ~ Cond + Sex + Wt1 + (1|id),family = poisson,
data = cereal)
norm_err_pois_mod <- glmer(C1 ~ Cond + Sex + Wt1 + (1|id),family = poisson,
data = cereal)
summary(norm_err_pois_mod)
kable(summary(norm_err_pois_mod)$coefficients)
library(MASS)
neg_binom_mod <- glm.nb(C1 ~ Cond + Sex + Wt1, link=log, data=cereal)
kable(summary(neg_binom_mod)$coefficients)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(MASS)
library(lme4)
library(tidyverse)
pois_mod <- glm(C1 ~ Cond + Sex + Wt1, data = cereal, family = poisson(link=log))
kable(summary(pois_mod)$coefficients)
pois_mod <- glm(C1 ~ Cond + Sex + Wt1, data = cereal, family = poisson(link=log))
kable(summary(pois_mod)$coefficients)
exp(summary(pois_mod)$coefficients)
confint(pois_mod)
exp(confint(pois_mod))
1 - 0.819695
quasi_pois_mod <- glm(C1 ~ Cond + Sex + Wt1, data = cereal, family = quasipoisson(link=log))
kable(summary(quasi_pois_mod)$coefficients)
kable(summary(pois_mod)$coefficients)
exp(summary(quasi_pois_mod)$coefficients)
exp(confint(quasi_pois_mod))
norm_err_pois_mod <- glmer(C1 ~ Cond + Sex + Wt1 + (1|id),family = poisson,
data = cereal)
kable(summary(norm_err_pois_mod)$coefficients)
exp(summary(norm_err_pois_mod)$coefficients)
exp(confint(norm_err_pois_mod))
neg_binom_mod <- glm.nb(C1 ~ Cond + Sex + Wt1, link=log, data=cereal)
kable(summary(neg_binom_mod)$coefficients)
kable(summary(neg_binom_mod)$coefficients)
exp(summary(neg_binom_mod)$coefficients)
exp(confint(neg_binom_mod))
coefficients(pois_mod)
summary(pois_mod)$coefficients
summary(pois_mod)$coefficients[,2]
summary(pois_mod)$coefficients[,2] * 1.7160
summary(pois_mod)$coefficients[,"Std.Error"]
summary(pois_mod)$coefficients[,2]
pois_ses <- summary(pois_mod)$coefficients[,2]
pois_ses <- summary(pois_mod)$coefficients[,2]
pois_ses
pois_ses * scale
pois_ses
scale <- 1.716
pois_ses * scale
pois_ses * scale == summary(quasi_pois_mod)$coefficients[,2]
summary(quasi_pois_mod)$coefficients[,2]
round(pois_ses * scale,4) == round(summary(quasi_pois_mod)$coefficients[,2],4)
scale <- 1.716
pois_ses <- summary(pois_mod)$coefficients[,2]
pois_ses
pois_ses * scale
round(pois_ses * scale,4) == round(summary(quasi_pois_mod)$coefficients[,2],4)
scale <- 1.716
pois_ses <- summary(pois_mod)$coefficients[,2]
pois_ses
pois_ses * scale
summary(quasi_pois_mod)$coefficients[,2]
summary(quasi_pois_mod)$coefficients[,2] / summary(pois_mod)$coefficients[,2]
scale <- 1.716002
pois_ses <- summary(pois_mod)$coefficients[,2]
pois_ses
pois_ses * scale
summary(quasi_pois_mod)$coefficients[,2]
chart <- as.data.frame(matrix(ncol = 4,nrow = 5))
chart <- as.data.frame(matrix(ncol = 4,nrow = 5))
colnames(chart) <- c("Poisson Regression","Poisson QL","Poisson + Normal Error",
"Negative Binomial")
rownames(chart) <- c("Intercept","Condition","Sex","Weight","Other Parameter")
View(chart)
chart$`Poisson Regression` <- c(coefficients(pois_mod),NA)
View(chart)
chart$`Poisson QL` <- c(coefficients(quasi_pois_mod),NA)
chart$`Poisson + Normal Error` <- c(coefficients(norm_err_pois_mod),NA)
coefficients(norm_err_pois_mod)
summary(norm_err_pois_mod)$tTable
summary(norm_err_pois_mod)$coefficients
chart$`Poisson + Normal Error` <- c(summary(norm_err_pois_mod)$coefficients[,1],NA)
summary(neg_binom_mod)$coefficients[,1]
chart$`Negative Binomial` <- c(summary(neg_binom_mod)$coefficients[,1],NA)
kable(chart)
chart[2:4,] <- exp(chart[2:4,])
kable(chart)
chart <- round(chart,3)
