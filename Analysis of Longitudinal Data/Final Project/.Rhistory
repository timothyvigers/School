# Convert column types - all seasons
numcols <- c("Season","AST","FG","FGA","FGP","3P","3PA","3P%","STL",
"BLK","TOV","PF","PTS","W","L","Age","Wt.")
all_seasons[,numcols] <- lapply(all_seasons[,numcols],
function(x) as.numeric(as.character(x)))
# Team and season
all_seasons$team_season <- paste(all_seasons$Team,all_seasons$Season)
# Convert column types - passing
passing$Season <- sub("-.*","",passing$Season)
numcols <- c("Season","Passes.Made","Min")
passing[,numcols] <- lapply(passing[,numcols],
function(x) as.numeric(as.character(x)))
# Per game
all_seasons$G
all_seasons <- all_seasons %>%
mutate(AST_perc = (AST / FG)*100,
AST_game = AST / G,
STL_game = STL / G,
BLK_game = BLK / G,
TOV_game = TOV / G,
PTS_game = PTS / G)
# Since merger
post_merger <- all_seasons[all_seasons$Season > 1976,]
post_merger <- post_merger %>% arrange(Team,Season)
# Win percentage
post_merger$w_perc <- (post_merger$W / (post_merger$W + post_merger$L))*100
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + PTS_game + FGP,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
View(post_merger)
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + PTS_game + FGP,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
View(post_merger)
# Get data from basketball reference
source("./Code/scrape.R")
# Read in passing CSV
passing <- read.csv("./Data/passing_data.csv")
# Colors
source("./Code/colors.R")
# Season to starting year
all_seasons$Season <- sub("-.*","",all_seasons$Season)
# Column names
colnames(all_seasons)[which(colnames(all_seasons)=="FG%")] <- "FGP"
# Height
all_seasons$Ht. <- as.numeric(sub(".*-","",all_seasons$Ht.)) + (6*12)
# Convert column types - all seasons
numcols <- c("Season","AST","FG","FGA","FGP","3P","3PA","3P%","STL",
"BLK","TOV","PF","PTS","W","L","Age","Wt.","G")
all_seasons[,numcols] <- lapply(all_seasons[,numcols],
function(x) as.numeric(as.character(x)))
# Team and season
all_seasons$team_season <- paste(all_seasons$Team,all_seasons$Season)
# Convert column types - passing
passing$Season <- sub("-.*","",passing$Season)
numcols <- c("Season","Passes.Made","Min")
passing[,numcols] <- lapply(passing[,numcols],
function(x) as.numeric(as.character(x)))
# Per game
all_seasons$G
all_seasons <- all_seasons %>%
mutate(AST_perc = (AST / FG)*100,
AST_game = AST / G,
STL_game = STL / G,
BLK_game = BLK / G,
TOV_game = TOV / G,
PTS_game = PTS / G)
# Since merger
post_merger <- all_seasons[all_seasons$Season > 1976,]
post_merger <- post_merger %>% arrange(Team,Season)
# Win percentage
post_merger$w_perc <- (post_merger$W / (post_merger$W + post_merger$L))*100
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + PTS_game + FGP,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
# Mediation with FGP as mediator
mod.y <- lmer(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + PTS_game +
FGP + (1|Team),data = post_merger)
mod.m <- lmer(FGP ~ AST_game + Age + `Ht.` + `Wt.` + STL_game + BLK_game + TOV_game +PTS_game +
(1|Team),data = post_merger)
med_fgp <- mediate(mod.m,mod.y,treat = "AST_game",mediator = "FGP")
# Mediation with AST as mediator
mod.y <- lmer(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + PTS_game +
FGP + (1|Team),data = post_merger)
mod.m <- lmer(AST_game ~ FGP + Age + `Ht.` + `Wt.` + STL_game + BLK_game + TOV_game +
PTS_game + (1|Team),data = post_merger)
med_ast <- mediate(mod.m,mod.y,treat = "FGP",mediator = "AST_game")
# Mediation summary
summary(med_fgp)
summary(med_ast)
# Mediation with FGP as mediator
mod.y <- lmer(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + PTS_game +
FGP + (1|Team),data = post_merger)
mod.m <- lmer(FGP ~ AST_game + Age + `Ht.` + `Wt.` + STL_game + BLK_game + TOV_game +PTS_game +
(1|Team),data = post_merger)
# Raw assist number plot
pass_plot <-
ggplot(passing,aes(x = Season,y = Passes.Made,group = Team)) +
geom_line(aes(color = Team)) + theme_bw() +
scale_color_manual(values = primary_colors) +
ylab("Passes Made")
pass_plot
# Raw assist number plot
pass_plot <-
ggplot(passing,aes(x = Season,y = Passes.Made,group = Team)) +
geom_smooth() + theme_bw() +
scale_color_manual(values = primary_colors) +
ylab("Passes Made")
pass_plot
# Raw assist number plot
pass_plot <-
ggplot(passing,aes(x = Season,y = Passes.Made)) +
geom_smooth() + theme_bw() +
scale_color_manual(values = primary_colors) +
ylab("Passes Made")
pass_plot
# Raw assist number plot
pass_plot <-
ggplot(passing,aes(x = Season,y = Passes.Made,group = Team)) +
geom_line(aes(color = Team)) + theme_bw() +
scale_color_manual(values = primary_colors) +
ylab("Passes Made")
pass_plot
hist(passing$Passes.Made)
hist(passing$Passes.Made)
hist(passing$Passes.Made)
View(passing)
hist(passing$Passes.Made,xlab = "Passes Made",main = "")
View(passing)
passing <- passing %>% arrange(Team,Season)
passing_mod <- lme(Passes.Made ~ Season, random = ~1|Team,
data = passing,method = "ML")
passing_mod_ar1 <- lme(Passes.Made ~ Season, random = ~1|Team,
data = passing,correlation = corAR1(),method = "ML")
passing_mod_ar1_s <- lme(Passes.Made ~ Season, random = ~Season|Team,
data = passing,correlation = corAR1(),method = "ML")
aics <- as.data.frame(AIC(passing_mod,passing_mod_ar1,passing_mod_ar1_s))
rownames(aics) <- c("RI Only","RI and AR(1)","RI, RS, and AR(1)")
kable(aics)
aics
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Final Project")
source("/Users/timvigers/Documents/GitHub/Tim-and-Laura/tim_r_functions.R")
library(car)
library(mediation)
library(nlme)
library(lme4)
library(MASS)
library(knitr)
kable(aics)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Final Project")
source("/Users/timvigers/Documents/GitHub/Tim-and-Laura/tim_r_functions.R")
library(car)
library(mediation)
library(nlme)
library(lme4)
library(MASS)
library(knitr)
library(tidyverse)
passing_mod_ar1 <- lme(Passes.Made ~ Season, random = ~1|Team,
data = passing,correlation = corAR1())
summary(passing_mod_ar1)
passing_mod_ar1 <- lme(Passes.Made ~ poly(Season,4), random = ~1|Team,
data = passing,correlation = corAR1())
summary(passing_mod_ar1)
# Raw assist number plot
pass_plot <-
ggplot(passing,aes(x = Season,y = Passes.Made,group = Team)) +
geom_line(aes(color = Team)) + theme_bw() +
scale_color_manual(values = primary_colors) +
ylab("Passes Made")
pass_plot
anova(passing_mod_ar1)
as.expression(R^2)
format_nlme_out(passing_mod_ar1,varnames = c("Season","Season^2","Season^3","Season^4"))
format_nlme_out(passing_mod_ar1,varnames = c("Season","Season^2","Season^3","Season^4"))
```{r pass results,echo=FALSE,results='asis'}
passing_mod_ar1 <- lme(Passes.Made ~ poly(Season,4), random = ~1|Team,
data = passing,correlation = corAR1())
format_nlme_out(passing_mod_ar1,varnames = c("Season","Season^2","Season^3","Season^4"))
model <- passing_mod_ar1
results <- as.data.frame(summary(model)$tTable)
results
results <- round(results,digits)
results$`p-value` <- format.pval(results$`p-value`,eps = eps)
varnames = c("Season","Season^2","Season^3","Season^4")
rownames(results) <- gsub(rownames(results)[n+1],varnames[n],rownames(results))
for (n in 1:length(varnames)) {
rownames(results) <- gsub(rownames(results)[n+1],varnames[n],rownames(results))
}
results
length(varnames)
n <- 1
rownames(results) <- gsub(rownames(results)[n+1],varnames[n],rownames(results))
results
rownames(results)
rownames(results)[n+1]
gsub(rownames(results)[n+1],varnames[n],rownames(results))
varnames
varnames[n]
rownames(results)[n+1]
for (n in 1:length(varnames)) {
rownames(results) <- sub(rownames(results)[n+1],varnames[n],rownames(results))
}
results
results <- as.data.frame(summary(model)$tTable)
results <- round(results,digits)
results$`p-value` <- format.pval(results$`p-value`,eps = eps)
if (!is.null(varnames)) {
for (n in 1:length(varnames)) {
rownames(results) <- gsub(rownames(results)[n+1],varnames[n],rownames(results))
}
}
results
format_nlme_out(passing_mod_ar1)
format_nlme_out(passing_mod_ar1,varnames = c("Season","Season^2","Season^3","Season^4"))
results <- format_nlme_out(passing_mod_ar1,kable = F)
rownames(results)
rownames(results) <- c("(Intercept)","Season","Season^2","Season^3","Season^4")
kable(results)
passing$season_star <- ifelse(passing$Season < 2015,0,passing$Season)
piecewise <- lme(Passes.Made ~ Season + season_star, random = ~1|Team,
data = passing,correlation = corAR1())
format_nlme_out(piecewise,varnames = c("Season","Change in Slope"),caption = NULL)
passing_mod_ar1 <- lme(Passes.Made ~ poly(Season,4), random = ~1|Team,
data = passing,correlation = corAR1())
results <- format_nlme_out(passing_mod_ar1,kable = F)
rownames(results) <- c("(Intercept)","Season","Season^2","Season^3","Season^4")
kable(results)
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + PTS_game + FGP,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
summary(mod)
# nlme
mod <- lme(w_perc ~ AST_game,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
summary(mod)
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + PTS_game,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
summary(mod)
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
summary(mod)
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + FGP,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
summary(mod)
# Mediation with FGP as mediator
mod.y <- lmer(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + PTS_game +
FGP + (1|Team),data = post_merger)
summary(mod.y)
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + FGP,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
summary(mod)
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game ,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
summary(mod)
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + FGP,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
# Mediation with FGP as mediator
mod.y <- lmer(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + PTS_game +
FGP, random = ~1|Team,data = post_merger)
# Mediation with FGP as mediator
mod.y <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + PTS_game +
FGP, random = ~1|Team,data = post_merger)
summary(mod.y)
# Mediation with FGP as mediator
mod.y <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + PTS_game +
FGP, random = ~1|Team,data = post_merger,correlation = corAR1())
summary(mod.y)
# Mediation with FGP as mediator
mod.y <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + PTS_game +
FGP, random = ~1|Team,data = post_merger)
summary(mod.y)
# Mediation with FGP as mediator
mod.y <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game +
FGP, random = ~1|Team,data = post_merger)
summary(mod.y)
# Mediation with FGP as mediator
mod.y <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game, random = ~1|Team,data = post_merger)
summary(mod.y)
# Mediation with FGP as mediator
mod.y <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game +
FGP, random = ~1|Team,data = post_merger)
summary(mod.y)
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + FGP,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
summary(mod)
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
summary(mod)
hist(post_merger$w_perc,xlab = "Win %",main = "")
mod <- lme(w_perc ~ AST_perc,random = ~1|Team,data = post_merger)
mod_s <- lme(w_perc ~ AST_perc,random = ~Season|Team,data = post_merger)
mod_ar1 <- lme(w_perc ~ AST_perc,random = ~1|Team,data = post_merger,
correlation = corAR1())
mod_ar1_s <- lme(w_perc ~ AST_perc,random = ~Season|Team,data = post_merger,
correlation = corAR1())
aics <- as.data.frame(AIC(mod,mod_s,mod_ar1,mod_ar1_s))
rownames(aics) <- c("RI Only","RI and RS","RI and AR(1)","RI, RS, and AR(1)")
kable(aics)
# Mediation with FGP as mediator
mod.y <- lmer(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game +
FGP + (1|Team),data = post_merger)
mod.m <- lmer(FGP ~ AST_game + Age + `Ht.` + `Wt.` + STL_game + BLK_game + TOV_game +
(1|Team),data = post_merger)
med_fgp <- mediate(mod.m,mod.y,treat = "AST_game",mediator = "FGP")
med_fgp
summary(med_fgp)
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + PTS_game,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
summary(mod)
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + PTS_game + FGP,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
summary(mod)
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + FGP,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
summary(mod)
# nlme
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game,
random = ~1|Team,data = post_merger,correlation = corAR1(),method = "ML")
summary(mod)
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game,
random = ~1|Team,data = post_merger,correlation = corAR1())
format_nlme_out(mod)
format_nlme_out(mod,varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG"))
format_nlme_out(mod2,varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG","FG%"))
format_nlme_out(mod2,varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG","FG%"))
mod2 <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + FGP,
random = ~1|Team,data = post_merger,correlation = corAR1())
format_nlme_out(mod2,varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG","FG%"))
format_nlme_out(mod2)
format_nlme_out(mod2,varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG","FG%"),caption = "WithFG%")
format_nlme_out(mod,varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG"),caption = "Without FG%")
format_nlme_out(mod2,varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG","FG%"),caption = "WithFG%")
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game,
random = ~1|Team,data = post_merger,correlation = corAR1())
mod2 <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + FGP,
random = ~1|Team,data = post_merger,correlation = corAR1())
format_nlme_out(mod,varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG"),caption = "Without FG%")
format_nlme_out(mod2,varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG","FG%"),caption = "WithFG%")
# Mediation with FGP as mediator
mod.y <- lmer(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game +
FGP + (1|Team),data = post_merger)
mod.m <- lmer(FGP ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game +
(1|Team),data = post_merger)
med_fgp <- mediate(mod.m,mod.y,treat = "AST_game",mediator = "FGP")
# Mediation with AST as mediator
mod.m <- lmer(AST_game ~ FGP + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game +
(1|Team),data = post_merger)
med_ast <- mediate(mod.m,mod.y,treat = "FGP",mediator = "AST_game")
summary(med_fgp)
summary(med_ast)
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game,
random = ~1|Team,data = post_merger,correlation = corAR1())
mod2 <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + FGP,
random = ~1|Team,data = post_merger,correlation = corAR1())
format_nlme_out(mod,varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG"),caption = "Without FG%")
format_nlme_out(mod2,varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG","FG%"),caption = "WithFG%")
results <- format_nlme_out(mod)
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game,
random = ~1|Team,data = post_merger,correlation = corAR1())
mod2 <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + FGP,
random = ~1|Team,data = post_merger,correlation = corAR1())
results <- format_nlme_out(mod)
results2 <- format_nlme_out(mod2)
format_nlme_out(mod,varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG"),caption = "Without FG%")
format_nlme_out(mod2,varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG","FG%"),caption = "WithFG%")
results
results <- format_nlme_out(mod,kable = F)
results2 <- format_nlme_out(mod2,kable = F)
results
results["AST_game","Value"]*5
1.64 * 5
round(results["AST_game","Value"]*5,3)/100
round(results["AST_game","Value"]*5,3)/100 * 82
floor(results["AST_game","Value"]*5/100 * 82)
round(results["AST_game","Value"]*5/100 * 82)
round(results["AST_game","Value"]*5/100 * 82,1)
format_nlme_out(mod2,varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG","FG%"),caption = "With FG%")
results["AST_game","p-value"]
results["AST_game","p-value"]
round(results["AST_game","Value"]*5,3)
round(results["AST_game","Value"]*5/100 * 82,1)
results <- format_nlme_out(mod,
varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG"),
kable = F)
results2 <- format_nlme_out(mod2,
varnames =
c("APG","Age","Ht.","Wt.","SPG","BPG","TPG","FG%"),
kable = F)
# Mediation summary
kable(summary(med_fgp))
# Mediation summary
summary(med_fgp)
summary(med_ast)
# Mediation summary
temp <- summary(med_fgp)
# Mediation summary
temp <- summary(med_fgp)
temp$d.avg.ci.group
# Mediation with FGP as mediator
mod.y <- lmer(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game +
FGP + (1|Team),data = post_merger)
mod.m <- lmer(FGP ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game +
(1|Team),data = post_merger)
med_fgp <- mediate(mod.m,mod.y,treat = "AST_game",mediator = "FGP")
# Mediation with AST as mediator
mod.m <- lmer(AST_game ~ FGP + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game +
(1|Team),data = post_merger)
med_ast <- mediate(mod.m,mod.y,treat = "FGP",mediator = "AST_game")
# Mediation summary
summary(med_fgp)
summary(med_ast)
# Mediation summary
summary(med_fgp)
summary(med_ast)
format_nlme_out(mod,
varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG"),
caption = "Without FG%")
?mediate
mod_ar1 <- lme(FGP ~ AST_perc,random = ~1|Team,data = post_merger,
correlation = corAR1())
mod_ar1
summary(mod_ar1)
mod <- lme(w_perc ~ AST_game,random = ~1|Team,data = post_merger)
mod_s <- lme(w_perc ~ AST_game,random = ~Season|Team,data = post_merger)
mod_ar1 <- lme(w_perc ~ AST_game,random = ~1|Team,data = post_merger,
correlation = corAR1())
mod_ar1_s <- lme(w_perc ~ AST_game,random = ~Season|Team,data = post_merger,
correlation = corAR1())
aics <- as.data.frame(AIC(mod,mod_s,mod_ar1,mod_ar1_s))
rownames(aics) <- c("RI Only","RI and RS","RI and AR(1)","RI, RS, and AR(1)")
kable(aics)
mod_ar1 <- lme(FGP ~ AST_game,random = ~1|Team,data = post_merger,
correlation = corAR1())
summary(mod_ar1)
mod_ar1 <- lme(FGP ~ AST_game +Age + Ht. + Wt. + STL_game + BLK_game + TOV_game,random = ~1|Team,data = post_merger,
correlation = corAR1())
summary(mod_ar1)
mod <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game,
random = ~1|Team,data = post_merger)
mod2 <- lme(w_perc ~ AST_game + Age + Ht. + Wt. + STL_game + BLK_game + TOV_game + FGP,
random = ~1|Team,data = post_merger)
results <- format_nlme_out(mod,kable = F)
results2 <- format_nlme_out(mod2,kable = F)
format_nlme_out(mod,
varnames = c("APG","Age","Ht.","Wt.","SPG","BPG","TPG"),
caption = "Without FG%")
results["AST_game","p-value"]
round(results["AST_game","Value"]*5,3)
round(results["AST_game","Value"]*5/100 * 82,1)
1.924*5
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "/Users/timvigers/Documents/GitHub/School/Analysis of Longitudinal Data/Final Project")
source("/Users/timvigers/Documents/GitHub/Tim-and-Laura/tim_r_functions.R")
library(DiagrammeR)
library(car)
library(mediation)
library(nlme)
library(lme4)
library(MASS)
library(knitr)
library(tidyverse)
mod <- lme(w_perc ~ AST_game,random = ~1|Team,data = post_merger,method = "ML")
mod_s <- lme(w_perc ~ AST_game,random = ~Season|Team,data = post_merger,method = "ML")
mod_ar1 <- lme(w_perc ~ AST_game,random = ~1|Team,data = post_merger,method = "ML",
correlation = corAR1())
mod_ar1_s <- lme(w_perc ~ AST_game,random = ~Season|Team,data = post_merger,
method = "ML",
correlation = corAR1())
aics <- as.data.frame(AIC(mod,mod_s,mod_ar1,mod_ar1_s))
rownames(aics) <- c("RI Only","RI and RS","RI and AR(1)","RI, RS, and AR(1)")
kable(aics)
library(diagram)
install.packages("diagram")
library(diagram)
?plotmat
data <- c(0,"",0,
0,0,0,
"","",0)
M<- matrix (nrow=3, ncol=3, byrow = TRUE, data=data)
plot<- plotmat (M, pos=c(1,2),
name= c( "Math self-efficacy","Math ability", "Interest in the math major"),
box.type = "rect", box.size = 0.12, box.prop=0.5,  curve=0)
plot<- plotmat (M, pos=c(1,2),
name= c("Math self-efficacy","Math ability",
"Interest in the math major"),
box.type = "rect", box.prop=0.5,  curve=0)
plot<- plotmat (M, pos=c(1,2),
name= c("Math self-efficacy","Math ability",
"Interest in the math major"),
box.type = "rect", box.size = 0.22, box.prop=0.5,  curve=0)
plot<- plotmat (M, pos=c(1,2),
name= c("Math self-efficacy","Math ability",
"Interest in the math major"),
box.type = "rect", box.size = 0.15, box.prop=0.5,  curve=0)
plot<- plotmat (M, pos=c(1,2),
name= c("Field Goal %","Assists per Game",
"Win %"),
box.type = "rect", box.size = 0.15, box.prop=0.5,  curve=0)
