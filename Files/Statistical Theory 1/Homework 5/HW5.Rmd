---
title: 'Stats Theory I: HW 5'
author: "Mayla Boguslav"
date: "8/13/2018"
output: html_document
---

## Intro to R information
Create a new R markdown file: File -> New File -> R Markdown

Note: basic math can be done in R as well. Example:

```{r basicmath}
(5 + 6) / (7 * 3)
```
If you need help with a function, type in help("function")

Learning objectives: plot3d

Reviewing: sum(dbinom), curve


## 4 (C+B 3.5)
A standard drug is known to be effective in 80% of the cases in which it is used. A new drug is tested on 100 patients and found to be effective in 85 cases. Is the new drug superior? (Hint: Evaluate the probability of observing 85 or more successes assuming that the new and old drugs are equally effective.)

Let X be the number of effective cases. If the new and old drugs are equally effective, then the let $p = 0.8$ be the probability that the new drug is effective. Assuming the cases are independent, we have a binomial distribution $(X ∼ (100, 0.8)$. Then the probability $X\geq 85$ is:

```{r 4}
sum(dbinom(size=100, prob = 0.8, x = c(85:100)))
```

So even if the new drug is better than the old one, the chance of 85 or more effective cases is not too small. Thus we cannot conclude that the new drug is better.

## 5 (C+B 3.7)
Let the number of chocolate chips in a certain type of cookie have a Poisson distribution. We want the probability that a randomly chosen cookie has at least two chocolate chips to be greater than 0.99. Find the smallest value of the mean of the distribution that ensures this probability.

$\lambda = 6.6384$

$y=\frac{e^{-\lambda}\lambda^x}{x!}$ (Discrete distribution)

```{r 5}
lambda = 6.6384
rpois(10,lambda) #randomly generate poisson data - specifically discrete meaning all integers
curve((exp(-lambda)*lambda^x)/ factorial(x), from=0, to=100, type="b", main="Poisson distribution")

```

## 7 (C+B 3.9)
Often news stories that are reported as startling "one-in-a-million" coinci- dences are actually, upon closer estimation, not rare events and can even be expected to occur. A few years ago an elementary school in New York state reported that its incoming kindergarten class contained five sets of twins. This, of course, was reported throughout the state, with a quote from the principal that this was a "statistical impossibility". Was it? Or was it an instance of what Diaconis and Mosteller (1999) call the "law of truly large numbers"? Let’s do some calculation.

(A) The probability of a twin birth is approximately 1 , and we can assume that an elementary school 90
with have approximately 60 children entering kindergarten (three classes of 20 each). Explain how
our "statistically impossible" event can be thought of as a probability of 5 or more successes from a
binomial(60, 1 ): Is this even rare enough to be newsworthy?

We can think of each one of the 60 children as an independent Bernoulli trial where a success is a twin birth and a failure is no twin birth, with the probability of twins at 1 . Then X ∼ Binomial(60, 1 and the probability of having at least 5 sets of twins in the class is:

```{r 7a}
1-sum(dbinom(size=60, prob=(1/(90)), x=c(0:4)))
```

0.0006 is small and so it may be newsworthy.


(B) Even if the probability in part (a) is rare enough to be newsworthy, consider that this could have happened in any school in the country, and in any county in the state, and it still would have been reported exactly the same. (The "law of truly large numbers" is starting to come into play). New York state has 62 counties, and it is reasonable to assume that each county has 5 elementary schools. Does the event still qualify as a "statistical impossibility", or is it becoming something that could be expected to occur?

Let X be the number of elementary schools with 5 or more sets of twins entering kindergarten. Then we have 62 × 5 = 310 total elementary schools. Then X ∼ binomial(310, 0.0006). We then want to know the probability that at least 1 school has 5 or more sets of twins:

```{r 7b}
1-dbinom(size=310, prob=0.0006, x=0)
```

The probability is getting larger as our sample size increases.


(C) If the probability in part (b) still seems small, consider further that this event could have happened in any one of the 50 states, during any of the last 10 years, and still would have received the same news coverage.

Let X be the number of states that have 5 or more sets of twins entering kindergarten during any of the last 10 years. Thus there are 50 × 10 = 500 kindergarten beginnings over the last 10 years. Now X ∼ binomial(500, 0.1698) and we want to know the probability of at least 1 state and 1 school had 5 or more sets of twins over the last 10 years:

```{r 7c}
1-dbinom(size=500, prob=0.1698, x=0)

```

Thus it is almost guaranteed that this would happen.

## 12 (C+B 3.33) 
For each of the following families:

• Verify that it is an exponential family

• Describe the curve on which the θ parameter vector lies

• Sketch a graph of the curved parameter space


(A) nonnegative real line - only 1 w so the whole real line
```{r 12a}
curve(x*0,0, 100, type="l",xlab="w1",ylab="w1")
```

(B) Parabola
```{r 12b}
curve(x^2, -100,100, type="l", xlab="w1",ylab="w2")
```

(C)
```{r 12c}
curve(x*1, 0,100, type="l", xlab="w1",ylab="w2")
```

(D) 
```{r setup}
##setup for an interactive plot in knitr
library(knitr)
library(rgl)
knit_hooks$set(webgl = hook_webgl)
```

```{r 12d, webgl=TRUE}
##need webgl=TRUE to initiate setup to get the graph inside the webpage

##you can zoom in and out, and twist the graph to explore it
##different perspectives - the last one is showing 
curve(x^2, -100,100, type="l", xlab="theta",ylab="parameter space")
x<-seq(-1,1,.001)
plot3d(x,x^2,x^3,xlab="theta",ylab="theta^2",zlab="theta^3")
plot3d(x,x^3,x^2,xlab="theta",ylab="theta^3",zlab="theta^2")             # change perspective
plot3d(x^2,x^3,x,xlab="theta^2",ylab="theta^3",zlab="theta")
plot3d(x^3,x,x^2,xlab="theta^2",ylab="theta^3",zlab="theta")                                                        #kinda cool
```